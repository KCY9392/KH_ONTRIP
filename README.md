

# KH_ONTRIP Project
## :busts_in_silhouette: 팀명: 시나브로
시나브로란 천천히 조금씩 부족한 부분을 서로 채워나가서 성장해나간다는 의미로,
저희 팀원들이 서로 부족한 부분을 채워주며,점점 성장해나가서 퀄리티 좋은 프로젝트를 해내자는 의미로 팀명을 정하였습니다.
### [OnTrip] 여행코스 추천 & 예약 웹사이트

<br>
<img src="https://user-images.githubusercontent.com/113049166/217443399-0394c1cb-66bf-4bf1-a4b9-4de63cdebeea.png">

<br>

## <img src="https://user-images.githubusercontent.com/113049166/222699301-ce14e886-186b-4241-91fc-132ba832cbe9.png" width="35px" height="35px"> 프로젝트소개

 <img src="https://user-images.githubusercontent.com/113049166/217443263-16ab6f38-9476-4926-a6f1-1cd5d70a70b5.png" width="80%" height="20%">

<br>

## <img src="https://user-images.githubusercontent.com/113049166/222700339-680fc1d0-6047-48e2-8f3e-4c55c9916e82.png" width="35px" height="35px"> 업무분담

 <img src="https://user-images.githubusercontent.com/113049166/222875251-f172a0ef-8dea-492e-bf31-1d05af0c8709.png" width="80%" height="20%">

<table style="margin-left: auto; margin-right: auto; width: 600px; height: 200px;">
            <tr>
                <td>이름</td>
                <td>김채영</td>
                <td>송지호</td>
                <td>이범석</td>
                <td>황종수</td>
                <td>조성우</td>
            </tr>
            <tr>
                <td>GitHub</td>
                <td><a href="https://github.com/KCY9392">@KCY9392</a></td>
                <td><a href="https://github.com/SongJiho1998">@SongJiho1998</a></td>
                <td><a href="https://github.com/qjatjr0513">@qjatjr0513</a></td>
                <td><a href="https://github.com/prodaniel93">@prodaniel93</a></td>
                <td><a href="https://github.com/jay11234511">@jay11234511</a></td>
            </tr>
  </table>
  
  <br>
  
## :computer: 개발환경
### :pencil: Front-End
<div>
	<img src="https://img.shields.io/badge/HTML5-E34F26?style=flat&logo=HTML5&logoColor=white" />
	<img src="https://img.shields.io/badge/CSS3-1572B6?style=flat&logo=CSS3&logoColor=white" />
	<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat&logo=JavaScript&logoColor=white" />
	<img src="https://img.shields.io/badge/jQuery-0769AD?style=flat&logo=jQuery&logoColor=white" />	
	<img src="https://img.shields.io/badge/Bootstrap-7952B3?style=flat&logo=Bootstrap&logoColor=white" />
</div>
	
   ### :pencil: Back-End
<div>
	<img src="https://img.shields.io/badge/Java-007396?style=flat&logo=Java&logoColor=white" />
	<img src="https://img.shields.io/badge/Oracle-F80000?style=flat&logo=Oracle&logoColor=white" />
	<img src="https://img.shields.io/badge/Apache Tomcat-F8DC75?style=flat&logo=Apache Tomcat&logoColor=white" />
</div>

  ## :computer: Tool	
<div>
   <img src="https://img.shields.io/badge/Eclipse IDE-2C2255?style=flat&logo=Eclipse IDE&logoColor=white" />
	<img src="https://img.shields.io/badge/Discord-5865F2?style=flat&logo=Discord&logoColor=white" />
	<img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white" />	
</div>

<br>

## :book: 프로젝트 작업 기간
- 2022.10.24-2022.10.27 : 프로젝트 기획 및 요구사항 분석
- 2022.10.28-2022.11.02 : 화면설계 
- 2022.11.03-2022.11.08 : DB설계
- 2022.11.09-2022.11.28 : 기능 구현
  
<br>

## 😀 ER-DIAGRAM , USECASE-DIAGRAM
<table>
<tr>
	<th>
	  ER-DIAGRAM
	</th>
	<th>
	  USECASE-DIAGRAM
	</th>
</tr>
<tr>
	<td width="50%">
		<img src="https://user-images.githubusercontent.com/113049166/222875314-82417840-b0bb-4895-a153-c651c81f266c.png" width="600" height="200"/>
	</td>
	<td width="50%">
		<img src="https://user-images.githubusercontent.com/113049166/222875346-0b5c2707-4995-49a0-a1ad-518aaf23cc20.jpg" width="600" height="200"></td>
</tr>
</table>

<br>

## 😆 UI
<table>
<tr>
	<th>
		시작페이지
	</th>
	<th>
		메인페이지
	</th>

</tr>
<tr>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/106515028/218248617-77700c59-5ae9-49ec-ab5d-9507038417aa.png" width="600" height="200"/>
	</td>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/106515028/218249053-47be0b72-7aa1-48a7-a31d-48f4730cabd8.png" width="600" height="200"></td>

</tr>
<tr>
	<th>
	    지역정보
	</th>
	<th>해당지역의 시설정보</th>
</tr>
<tr>
	<td>
	 <img src="https://user-images.githubusercontent.com/106515028/218249213-f37d2b31-906f-489d-953d-fd4ba914fa7c.png" width="600" height="200"/>
	</td>
	<td>
	  <img src="https://user-images.githubusercontent.com/106515028/218249423-8deb878e-c599-4537-ae02-3a8784b558bd.png" width="600" height="200"/>
	</td>
</tr>
<tr>
	<th>시설이용후기
	</th>
	<th>
	    시설이용후기 상세
	</th>
</tr>
<tr>

	<td>
	  <img src="https://user-images.githubusercontent.com/113049166/222876375-19d98e68-59b1-4577-ad10-914b4bb159ea.png" width="600" height="200"/>
	</td>
	<td>
	  <img src="https://user-images.githubusercontent.com/113049166/222876384-9d2364d9-3a73-46f8-897b-e691942d8cd0.png" width="600" height="200"/>
	</td>
<tr>
<tr>
	<th>시설선택창
	</th>
	<th>
	    예약창
	</th>
</tr>
<tr>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222876421-c01e6293-cd9d-400f-8279-994c92efa151.png" width="600" height="200"/>
	</td>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222876445-49fa0704-c9c9-4973-a64e-10beb288cda5.png" width="600" height="200"/>
	</td>
<tr>
<tr>
	<th>예약확인창
	</th>
	<th>
	    마이페이지
	</th>
</tr>
<tr>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222876477-9cbc17d6-c3af-43af-b4fa-c2f208fdcb03.png" width="600" height="200"/>
	</td>
	<td>
	   <img src="https://user-images.githubusercontent.com/113049166/222876488-c1c6b3d2-a06f-4c2a-ace5-0bea2a0476c6.png" width="600" height="200"/>
	</td>
<tr>	
</table>

<br>
  
## 🌟 주요기능
#### 1) 채팅첨부파일 보내기 기능

<img src="https://user-images.githubusercontent.com/113049166/222718256-1cf90370-c99d-4f9d-b6e3-24cd6e9f16c2.png" width="80%" height="20%">

	/* 채팅 보내기 버튼 눌렀을 경우, */
           $("#send").on('click',function(){
        	   $.ajax({
                   type: "post",
                   url: "${pageContext.request.contextPath}/chat/chatFile/insert",
                   data: new FormData($("#uploadfileForm")[0]),
                   processData: false,
                   contentType: false,
                   success: function (rsp) {
                	   
                	   let changeName = rsp.changeName;
                       let originName = rsp.originName;
                	   
                       let ext = originName.split('.').pop().toLowerCase();
                       if ($.inArray(ext, ['jpg', 'jpeg', 'png', 'gif']) != -1) {
                    	   
                    	   let wsJson = {
                    			   "chatContent": "<img src='/tresure/resources/images/chat/"+changeName+"' style='width: 200px'><br>",
                    			   "chatRoomNo": chatRoomNo,
                                   "userNo": userNo
                    	   };
                    	   //JSON 전송
                           $("#uploadfile").val("");
                           ws.send(JSON.stringify(wsJson));
                           $(".chatImageBeforeSetImage").css('display','none');
                           $('#View').attr('src', "");
                           return false;
                       }
                	   
                   },
                   error : function(data){
                	 alert("오류");   
                   }
                });
           });
	   

1. [보내기] 버튼 누를경우, ajax로 input file안의 데이터를 form으로 감싸서 chatFile/insert url로 post방식으로 보냅니다. 
2. 이미지 데이터를 받은 controller에서 이미지를 저장할 서버저장폴더를 생성,이미지 저장하고
3. DB에 이미지를 등록시키도록 service단으로 이미지객체를 넘깁니다. 
4. 이미지의 원본명, 수정명을 map에 담아서 ajax결과값으로 보내주고, 그 결과값인 이미지 정보를 이미지태그로 만들고, Json객체로 감싸서 Websocket에 send합니다.
5. 그 결과, 채팅창에 이미지가 출력됩니다.

<br><br>
#### 2) 최근 본 상품 기능
<table>
<tr>
	<th>
	  아직 상품 조회 X
	</th>
	<th>
	  상품조회
	</th>
	<th>
	  상품 조회 시,
	</th>
</tr>
<tr>
	<td width="10%">
		<img src="https://user-images.githubusercontent.com/113049166/222720430-4e92aa76-e435-4bbe-9f24-fb811c8abb7b.png" width="600" height="200"/>
	</td>
	<td width="30%">
		<img src="https://user-images.githubusercontent.com/113049166/222720807-f550b0b2-3bdf-4fe1-8ffd-7e42a13c6d27.png" width="600" height="200"></td>
	<td width="10%">
		<img src="https://user-images.githubusercontent.com/113049166/222720824-7beb0401-97af-4b95-a07e-ad04cdf4266f.png" width="600" height="200"></td>
</tr>
</table>

	// localStorage에서 products 키값 가져오기.
	let sideBarProducts = localStorage.getItem("products");

	// 만약 products가 undefined가 아니라면 list 변수에 JSON.parse(sideBarProducts)를 통해서 JSON Array를 만들고, 그게 아니라면 list 변수를 새로운 배열로 생성한다.
	let sideBarList = sideBarProducts ? JSON.parse(sideBarProducts) : [];

	<c:choose>
		<c:when test="${sessionScope.loginUser != null}">
			let sideBarUrl = "${pageContext.request.contextPath}/recent/" + (sideBarList ? "update" : "products");

			$.ajax({
				   async : false,
				   url : sideBarUrl,
				   data : JSON.stringify(sideBarList),
				   type : "post",
				   dataType : "json",
				   contentType : "application/json",
				   success : function(data) {

					localStorage.removeItem("products");
					$("#nrecentlyList").children().remove();
					$(data).each((i, elem) => {
						if (elem.crawl == "N") {
							elem.imgSrc = "${pageContext.request.contextPath}" + elem.imgSrc;
						}
						console.log("로그인 된 상태 -> href : ${pageContext.request.contextPath}/sell/sellDetail/" 
								+ elem.sellNo, ", imgSrc :", elem.imgSrc, ", crawl:", elem.crawl);
						$("#nrecentlyList").append($("<li>")
								   .append($("<a>", { href : "${pageContext.request.contextPath}/sell/sellDetail/" + elem.sellNo })
								   .append($("<img>", { src : elem.imgSrc }).addClass("nrecentlyImage")))
								   .append($("<input>", {type : "hidden", name : "recentNo", value : elem.recentNo}))
								   .append($("<input>", {type : "hidden", name : "sellNo", value : elem.sellNo}))
								   .append($("<input>", {type : "hidden", name : "imgSrc", value : elem.imgSrc}))
								   .append($("<input>", {type : "hidden", name : "crawl", value : elem.crawl}))
								   .append($("<button>", { text : "X", class : "deleteBtn" })))
						});
						$("#nrecentlyCnt").text(data.length);
					},
				   error : function() {
						console.log("오류 발생");
					}
				});
		</c:when>
	<c:otherwise>


- 로컬스토리지를 이용하여서 상품을 클릭 시, 상품상세페이지로 이동할때 상품정보를 로컬스토리지에 세팅하는 스크립트를 사용하였습니다. 
1. item변수에 상품객체를 담고, 
2. 2개이상의 상품을 저장하기위해 다시 list배열에 담아 로컬스토리지 키값에 저장시킵니다.
3. 이때의 키값을 sidebar.jsp에 전달시키고 이미지를 출력합니다.

<br><br>







